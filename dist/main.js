(()=>{"use strict";class s{constructor(s,t,e,a){this.capsIsOn=!1,this.language=s,this.codeName=t,this.layout={eng:{Low:e.Low,Up:e.Up,caps:e.caps,shiftCaps:e.shiftCaps},rus:{Low:a.Low,Up:a.Up,caps:a.caps,shiftCaps:a.shiftCaps}},this.current=this.layout[this.language].Low}createButton(){return this.btn=document.createElement("button"),this.btn.classList.add("button"),this.btn.classList.add(this.codeName),this.btn.textContent=this.current,this.btn}toggleShift(){this.capsIsOn?this.current===this.layout[this.language].caps?this.current=this.layout[this.language].shiftCaps:this.current===this.layout[this.language].shiftCaps&&(this.current=this.layout[this.language].caps):this.capsIsOn||(this.current===this.layout[this.language].Low?this.current=this.layout[this.language].Up:this.current===this.layout[this.language].Up&&(this.current=this.layout[this.language].Low)),this.btn.textContent=this.current}toggleCaps(){this.capsIsOn=!this.capsIsOn,this.capsIsOn?this.current=this.layout[this.language].caps:this.current=this.layout[this.language].Low,this.btn.textContent=this.current}addPressed(){this.btn.classList.add("pressed")}removePressed(){this.btn.classList.remove("pressed")}changeLanguage(s){this.language=s,this.capsIsOn?this.current=this.layout[this.language].caps:this.current=this.layout[this.language].Low,this.btn.textContent=this.current}}const t=[{codeName:"Backquote",rus:{Low:"ё",Up:"Ё",caps:"Ё",shiftCaps:"ё"},eng:{Low:"`",Up:"~",caps:"`",shiftCaps:"~"}},{codeName:"Digit1",rus:{Low:"1",Up:"!",caps:"1",shiftCaps:"!"},eng:{Low:"1",Up:"!",caps:"1",shiftCaps:"!"}},{codeName:"Digit2",rus:{Low:"2",Up:'"',caps:"2",shiftCaps:'"'},eng:{Low:"2",Up:"@",caps:"2",shiftCaps:"@"}},{codeName:"Digit3",rus:{Low:"3",Up:"№",caps:"3",shiftCaps:"№"},eng:{Low:"3",Up:"#",caps:"3",shiftCaps:"#"}},{codeName:"Digit4",rus:{Low:"4",Up:";",caps:"4",shiftCaps:";"},eng:{Low:"4",Up:"$",caps:"4",shiftCaps:"$"}},{codeName:"Digit5",rus:{Low:"5",Up:"%",caps:"5",shiftCaps:"%"},eng:{Low:"5",Up:"%",caps:"5",shiftCaps:"%"}},{codeName:"Digit6",rus:{Low:"6",Up:":",caps:"6",shiftCaps:":"},eng:{Low:"6",Up:"^",caps:"6",shiftCaps:"^"}},{codeName:"Digit7",rus:{Low:"7",Up:"?",caps:"7",shiftCaps:"?"},eng:{Low:"7",Up:"&",caps:"7",shiftCaps:"&"}},{codeName:"Digit8",rus:{Low:"8",Up:"*",caps:"8",shiftCaps:"*"},eng:{Low:"8",Up:"*",caps:"8",shiftCaps:"*"}},{codeName:"Digit9",rus:{Low:"9",Up:"(",caps:"9",shiftCaps:"("},eng:{Low:"9",Up:"(",caps:"9",shiftCaps:"("}},{codeName:"Digit0",rus:{Low:"0",Up:")",caps:"0",shiftCaps:")"},eng:{Low:"0",Up:")",caps:"0",shiftCaps:")"}},{codeName:"Minus",rus:{Low:"-",Up:"_",caps:"-",shiftCaps:"_"},eng:{Low:"-",Up:"_",caps:"-",shiftCaps:"_"}},{codeName:"Equal",rus:{Low:"=",Up:"+",caps:"=",shiftCaps:"+"},eng:{Low:"=",Up:"+",caps:"=",shiftCaps:"+"}},{codeName:"Backspace",rus:{Low:"Backspace",Up:"Backspace",caps:"Backspace",shiftCaps:"Backspace"},eng:{Low:"Backspace",Up:"Backspace",caps:"Backspace",shiftCaps:"Backspace"}},{codeName:"Tab",rus:{Low:"Tab",Up:"Tab",caps:"Tab",shiftCaps:"Tab"},eng:{Low:"Tab",Up:"Tab",caps:"Tab",shiftCaps:"Tab"}},{codeName:"KeyQ",rus:{Low:"й",Up:"Й",caps:"Й",shiftCaps:"й"},eng:{Low:"q",Up:"Q",caps:"Q",shiftCaps:"q"}},{codeName:"KeyW",rus:{Low:"ц",Up:"Ц",caps:"Ц",shiftCaps:"ц"},eng:{Low:"w",Up:"W",caps:"W",shiftCaps:"w"}},{codeName:"KeyE",rus:{Low:"у",Up:"У",caps:"У",shiftCaps:"у"},eng:{Low:"e",Up:"E",caps:"E",shiftCaps:"e"}},{codeName:"KeyR",rus:{Low:"к",Up:"К",caps:"К",shiftCaps:"к"},eng:{Low:"r",Up:"R",caps:"R",shiftCaps:"r"}},{codeName:"KeyT",rus:{Low:"е",Up:"Е",caps:"Е",shiftCaps:"е"},eng:{Low:"t",Up:"T",caps:"T",shiftCaps:"t"}},{codeName:"KeyY",rus:{Low:"н",Up:"Н",caps:"Н",shiftCaps:"н"},eng:{Low:"y",Up:"Y",caps:"Y",shiftCaps:"y"}},{codeName:"KeyU",rus:{Low:"г",Up:"Г",caps:"Г",shiftCaps:"г"},eng:{Low:"u",Up:"U",caps:"U",shiftCaps:"u"}},{codeName:"KeyI",rus:{Low:"ш",Up:"Ш",caps:"Ш",shiftCaps:"ш"},eng:{Low:"i",Up:"I",caps:"I",shiftCaps:"i"}},{codeName:"KeyO",rus:{Low:"щ",Up:"Щ",caps:"Щ",shiftCaps:"щ"},eng:{Low:"o",Up:"O",caps:"O",shiftCaps:"o"}},{codeName:"KeyP",rus:{Low:"з",Up:"З",caps:"З",shiftCaps:"з"},eng:{Low:"p",Up:"P",caps:"P",shiftCaps:"p"}},{codeName:"BracketLeft",rus:{Low:"х",Up:"Х",caps:"Х",shiftCaps:"х"},eng:{Low:"[",Up:"{",caps:"[",shiftCaps:"{"}},{codeName:"BracketRight",rus:{Low:"ъ",Up:"Ъ",caps:"Ъ",shiftCaps:"ъ"},eng:{Low:"]",Up:"}",caps:"]",shiftCaps:"}"}},{codeName:"Backslash",rus:{Low:"\\",Up:"/",caps:"\\",shiftCaps:"/"},eng:{Low:"\\",Up:"|",caps:"\\",shiftCaps:"|"}},{codeName:"Delete",rus:{Low:"Del",Up:"Del",caps:"Del",shiftCaps:"Del"},eng:{Low:"Del",Up:"Del",caps:"Del",shiftCaps:"Del"}},{codeName:"CapsLock",rus:{Low:"CapsLock",Up:"CapsLock",caps:"CapsLock",shiftCaps:"CapsLock"},eng:{Low:"CapsLock",Up:"CapsLock",caps:"CapsLock",shiftCaps:"CapsLock"}},{codeName:"KeyA",rus:{Low:"ф",Up:"Ф",caps:"Ф",shiftCaps:"ф"},eng:{Low:"a",Up:"A",caps:"A",shiftCaps:"a"}},{codeName:"KeyS",rus:{Low:"ы",Up:"Ы",caps:"Ы",shiftCaps:"ы"},eng:{Low:"s",Up:"S",caps:"S",shiftCaps:"s"}},{codeName:"KeyD",rus:{Low:"в",Up:"В",caps:"В",shiftCaps:"в"},eng:{Low:"d",Up:"D",caps:"D",shiftCaps:"d"}},{codeName:"KeyF",rus:{Low:"а",Up:"А",caps:"А",shiftCaps:"а"},eng:{Low:"f",Up:"F",caps:"F",shiftCaps:"f"}},{codeName:"KeyG",rus:{Low:"п",Up:"П",caps:"П",shiftCaps:"п"},eng:{Low:"g",Up:"G",caps:"G",shiftCaps:"g"}},{codeName:"KeyH",rus:{Low:"р",Up:"Р",caps:"Р",shiftCaps:"р"},eng:{Low:"h",Up:"H",caps:"H",shiftCaps:"h"}},{codeName:"KeyJ",rus:{Low:"о",Up:"О",caps:"О",shiftCaps:"о"},eng:{Low:"j",Up:"J",caps:"J",shiftCaps:"j"}},{codeName:"KeyK",rus:{Low:"л",Up:"Л",caps:"Л",shiftCaps:"л"},eng:{Low:"k",Up:"K",caps:"K",shiftCaps:"k"}},{codeName:"KeyL",rus:{Low:"д",Up:"Д",caps:"Д",shiftCaps:"д"},eng:{Low:"l",Up:"L",caps:"L",shiftCaps:"l"}},{codeName:"Semicolon",rus:{Low:"ж",Up:"Ж",caps:"Ж",shiftCaps:"ж"},eng:{Low:";",Up:":",caps:";",shiftCaps:":"}},{codeName:"Quote",rus:{Low:"э",Up:"Э",caps:"Э",shiftCaps:"э"},eng:{Low:"'",Up:'"',caps:"'",shiftCaps:'"'}},{codeName:"Enter",rus:{Low:"Enter",Up:"Enter",caps:"Enter",shiftCaps:"Enter"},eng:{Low:"Enter",Up:"Enter",caps:"Enter",shiftCaps:"Enter"}},{codeName:"ShiftLeft",rus:{Low:"Shift",Up:"Shift",caps:"Shift",shiftCaps:"Shift"},eng:{Low:"Shift",Up:"Shift",caps:"Shift",shiftCaps:"Shift"}},{codeName:"KeyZ",rus:{Low:"я",Up:"Я",caps:"Я",shiftCaps:"я"},eng:{Low:"z",Up:"Z",caps:"Z",shiftCaps:"z"}},{codeName:"KeyX",rus:{Low:"ч",Up:"Ч",caps:"Ч",shiftCaps:"ч"},eng:{Low:"x",Up:"X",caps:"X",shiftCaps:"x"}},{codeName:"KeyC",rus:{Low:"с",Up:"С",caps:"С",shiftCaps:"с"},eng:{Low:"c",Up:"C",caps:"C",shiftCaps:"c"}},{codeName:"KeyV",rus:{Low:"м",Up:"М",caps:"М",shiftCaps:"м"},eng:{Low:"v",Up:"V",caps:"V",shiftCaps:"v"}},{codeName:"KeyB",rus:{Low:"и",Up:"И",caps:"И",shiftCaps:"и"},eng:{Low:"b",Up:"B",caps:"B",shiftCaps:"b"}},{codeName:"KeyN",rus:{Low:"т",Up:"Т",caps:"Т",shiftCaps:"т"},eng:{Low:"n",Up:"N",caps:"N",shiftCaps:"n"}},{codeName:"KeyM",rus:{Low:"ь",Up:"Ь",caps:"Ь",shiftCaps:"ь"},eng:{Low:"m",Up:"M",caps:"M",shiftCaps:"m"}},{codeName:"Comma",rus:{Low:"б",Up:"Б",caps:"Б",shiftCaps:"б"},eng:{Low:",",Up:"<",caps:",",shiftCaps:"<"}},{codeName:"Period",rus:{Low:"ю",Up:"Ю",caps:"Ю",shiftCaps:"ю"},eng:{Low:".",Up:">",caps:".",shiftCaps:">"}},{codeName:"Slash",rus:{Low:".",Up:",",caps:".",shiftCaps:","},eng:{Low:"/",Up:"?",caps:"/",shiftCaps:"?"}},{codeName:"ArrowUp",rus:{Low:"↑",Up:"↑",caps:"↑",shiftCaps:"↑"},eng:{Low:"↑",Up:"↑",caps:"↑",shiftCaps:"↑"}},{codeName:"ShiftRight",rus:{Low:"Shift",Up:"Shift",caps:"Shift",shiftCaps:"Shift"},eng:{Low:"Shift",Up:"Shift",caps:"Shift",shiftCaps:"Shift"}},{codeName:"ControlLeft",rus:{Low:"Ctrl",Up:"Ctrl",caps:"Ctrl",shiftCaps:"Ctrl"},eng:{Low:"Ctrl",Up:"Ctrl",caps:"Ctrl",shiftCaps:"Ctrl"}},{codeName:"MetaLeft",rus:{Low:"Win",Up:"Win",caps:"Win",shiftCaps:"Win"},eng:{Low:"Win",Up:"Win",caps:"Win",shiftCaps:"Win"}},{codeName:"AltLeft",rus:{Low:"Alt",Up:"Alt",caps:"Alt",shiftCaps:"Alt"},eng:{Low:"Alt",Up:"Alt",caps:"Alt",shiftCaps:"Alt"}},{codeName:"Space",rus:{Low:" ",Up:" ",caps:" ",shiftCaps:" "},eng:{Low:" ",Up:" ",caps:" ",shiftCaps:" "}},{codeName:"AltRight",rus:{Low:"Alt",Up:"Alt",caps:"Alt",shiftCaps:"Alt"},eng:{Low:"Alt",Up:"Alt",caps:"Alt",shiftCaps:"Alt"}},{codeName:"ArrowLeft",rus:{Low:"←",Up:"←",caps:"←",shiftCaps:"←"},eng:{Low:"←",Up:"←",caps:"←",shiftCaps:"←"}},{codeName:"ArrowDown",rus:{Low:"↓",Up:"↓",caps:"↓",shiftCaps:"↓"},eng:{Low:"↓",Up:"↓",caps:"↓",shiftCaps:"↓"}},{codeName:"ArrowRight",rus:{Low:"→",Up:"→",caps:"→",shiftCaps:"→"},eng:{Low:"→",Up:"→",caps:"→",shiftCaps:"→"}},{codeName:"ControlRight",rus:{Low:"Ctrl",Up:"Ctrl",caps:"Ctrl",shiftCaps:"Ctrl"},eng:{Low:"Ctrl",Up:"Ctrl",caps:"Ctrl",shiftCaps:"Ctrl"}}];class e{static setLanguage(s){localStorage.setItem("keyboard-language",s)}static getLanguage(){return localStorage.getItem("keyboard-language")}}let a="eng";const p=new class{constructor(){this.content=document.createElement("div")}createPage(){this.content.classList.add("centralizer");const s=document.createElement("h1");s.textContent="Виртуальная клавиатура",s.classList.add("title"),this.content.append(s);const t=document.createElement("textarea");t.classList.add("textarea"),this.content.append(t);const e=document.createElement("p");e.textContent="Клавиатура создана в операционной системе Windows",e.classList.add("description"),this.content.append(e);const a=document.createElement("p");a.textContent="Для переключения языка комбинация: левыe ctrl + alt",a.classList.add("language"),this.content.append(a),document.body.append(this.content)}addKeyboard(s){this.textarea=document.querySelector(".textarea"),this.textarea.insertAdjacentElement("afterend",s)}};p.createPage(),e.getLanguage()?a=e.getLanguage():e.setLanguage(a);const i=new class{constructor(s="eng"){this.shiftIsPressed=!1,this.language=s,this.keys=[],this.layoutsKeys={alt:!1,ctrl:!1},this.textarea=document.querySelector(".textarea")}generateButtons(){this.keyboard=document.createElement("div"),this.keyboard.classList.add("keyboard");for(let e=0;e<t.length;e+=1){const a=t[e],p=new s(this.language,a.codeName,a.eng,a.rus);this.keyboard.append(p.createButton()),this.keys.push(p)}return this.keyboard}pressKey(s){const t=s.codeName;if("ShiftLeft"===t||"ShiftRight"===t)this.addShift();else if("CapsLock"===t)this.addCaps();else if("ControlLeft"===t||"ControlRight"===t)this.layoutsKeys.ctrl=!0,this.layoutsKeys.ctrl&&this.layoutsKeys.alt&&this.toggleLanguage();else if("AltLeft"===t||"AltRight"===t)this.layoutsKeys.alt=!0,this.layoutsKeys.ctrl&&this.layoutsKeys.alt&&this.toggleLanguage();else if("Enter"===t)this.sendToTextArea("\n");else if("Tab"===t)this.sendToTextArea("\t");else if("Backspace"===t)this.start=this.textarea.selectionStart,this.end=this.textarea.selectionEnd,this.textarea.selectionStart===this.textarea.selectionEnd&&(this.start-1<=0?this.start=0:this.start-=1),this.textarea.setRangeText("",this.start,this.end),this.textarea.selectionStart=this.start,this.textarea.selectionEnd=this.textarea.selectionStart;else if("Delete"===t)this.start=this.textarea.selectionStart,this.end=this.textarea.selectionEnd,this.textarea.selectionStart===this.textarea.selectionEnd&&(this.end+=1),this.textarea.setRangeText("",this.start,this.end),this.textarea.selectionStart=this.start,this.textarea.selectionEnd=this.textarea.selectionStart;else{if("MetaLeft"===t)return;this.sendToTextArea(s.current)}}cancelLayout(s){"ControlLeft"===s||"ControlRight"===s?this.layoutsKeys.ctrl=!1:"AltLeft"!==s&&"AltRight"!==s||(this.layoutsKeys.alt=!1)}toggleLanguage(){"rus"===this.language?this.language="eng":this.language="rus",this.keys.forEach((s=>s.changeLanguage(this.language))),e.setLanguage(this.language)}addCaps(){this.keys.forEach((s=>s.toggleCaps())),document.querySelector(".CapsLock").classList.toggle("caps-is-on")}addShift(){this.shiftIsPressed||(this.keys.forEach((s=>s.toggleShift())),this.shiftIsPressed=!0)}disableShift(s){this.shiftIsPressed&&("ShiftLeft"!==s&&"ShiftRight"!==s||this.removeShift())}removeShift(){this.shiftIsPressed=!1,this.keys.forEach((s=>s.toggleShift()))}sendToTextArea(s){this.start=this.textarea.selectionStart,this.end=this.textarea.selectionEnd,this.textarea.setRangeText(s),this.textarea.selectionStart=this.start+s.length,this.textarea.selectionEnd=this.textarea.selectionStart,this.textarea.scrollTop=this.textarea.scrollHeight,this.textarea.focus()}}(a),o=i.generateButtons();p.addKeyboard(o),o.childNodes.forEach((s=>{s.addEventListener("mousedown",(s=>{s.preventDefault();const t=s.target.classList[1],e=i.keys.find((s=>s.codeName===t));e&&(i.pressKey(e),e.addPressed())})),s.addEventListener("mouseup",(s=>{s.preventDefault();const t=s.target.classList[1],e=i.keys.find((s=>s.codeName===t));e&&("ControlLeft"!==t&&"ControlRight"!==t&&"AltLeft"!==t&&"AltRight"!==t||i.cancelLayout(e.codeName),i.disableShift(e.codeName),e.removePressed())}))})),window.addEventListener("keydown",(s=>{s.preventDefault();const t=i.keys.find((t=>t.codeName===s.code));t&&(i.pressKey(t),t.addPressed())})),window.addEventListener("keyup",(s=>{s.preventDefault();const t=i.keys.find((t=>t.codeName===s.code));t&&("ControlLeft"!==s.code&&"ControlRight"!==s.code&&"AltLeft"!==s.code&&"AltRight"!==s.code||i.cancelLayout(s.code),"ShiftLeft"!==s.code&&"ShiftRight"!==s.code||i.disableShift(s.code),t.removePressed())}))})();